## 第0章：课程介绍
多媒体
* 定义：多种媒体的综合，一般包括文本、声音和图像等
  

多媒体安全
* 挑战根源：数据拥有方和计算/使用方分离
* 矛盾：隐私保护与价值

可采用的技术手段
* 隐私计算
* 机密计算
* 联邦学习
----
## 第1章：绪论
安全概念：利用安全机制提供安全服务对抗安全攻击
* 安全攻击：损害信息安全的行为
  * 被动：获取通信内容、监控通讯流量
  * 主动：伪装身份、重放、ddos
* 安全服务：增强数据处理和传输过程安全性的服务
  * 认证
  * 访问控制
  * 机密性、完整性
  * 不可抵赖性
* 安全机制：用于阻止安全攻击或从中恢复的机制
  * 密码技术
  * 数字水印

多媒体应用的特点  
数据大、耗电、实时性、连续、同步、loss-tolerant、prioritized components、多级语义、different distribution channels

对多媒体数据的攻击
* 可用性：破坏多媒体，使其不能解码或失去观赏功能
* 保密性：未授权方非法获取多媒体信息，如窃听、违法复制文件
* 完整性：未授权方篡改多媒体文件数据
* 真实性：未授权方伪造和替换原有多媒体信息，对来源进行伪造，如伪造水印

多媒体数据的安全服务
* 源头安全
  * 嵌入数字水印
  * 加密
  * 防止非授权的访问和获取
  * 利用生物特征识别用户
* 传输安全
  * 密文传输
  * 利用信息隐藏传递秘密信息
  * 生物特征加密
* 获取安全
  * 嵌入数字指纹用于追踪用户
  * 哈希对获取信息进行验证
* 真实性鉴别
  * 数字水印
  * 数字媒体取证技术

多媒体数据安全保护机制的性能需求
* 多媒体数据比特率高，通常以压缩格式传输
  * 安全机制需与不同压缩标准兼容且不影响压缩效率
* 多媒体内容分析需要复杂算法
  * 安全机制支持复杂算法，不影响多媒体应用
* 多媒体数据为用户服务
  * 安全机制对用户透明
* 多媒体内容的不同部分有不同程度的敏感性
  * 安全机制需灵活支持不同级别的访问控制
* 多媒体内容包括多层语义
  * 安全机制需灵活支持多层语义
* 多媒体数据应用常使用大量实时数据，效率至关重要
  * 安全机制需实时处理大量数据
* 多媒体数据网络传输有特殊需求
  * 网络友好性

云视频监控
* 安全威胁
  * 内容篡改，非授权用户的访问
* 需求分析
  * 功能
    * 内容检测
  * 安全性
    * 访问控制
    * 完整性鉴定
    * 司法证据
  * 性能要求
    * 准确
    * 存储小
    * 延迟低
* 安全机制
  * 加密，认证，数字水印，隐私计算
----
## 第2章：多媒体基础
数字图像的表示单位-像素
* 二值：1位，0或1
* 灰度：8位，0~255
* 彩色：24位，3*0~255

数字视频  
* 视觉暂留现象
* 25-30帧每秒

为何压缩
* 数据量太大

压缩原理：冗余，掩蔽效应
* 视觉冗余
  * 亮度
  * 对比度
    * 邻域
    * 自对比
  * 色度
  * 时域
* 听觉冗余
  * 时域
  * 频域
* 统计冗余
  * 空域
  * 时域
  * 编码

压缩流程
* 分块，DCT，quantize，Zig-zag，run-lengh code，huffman code
* 量化
  * 不可逆，是信息损失的来源
  * 压缩的关键步骤
  * 量化误差，$eq=x-Q_{-1}(Q(x))$

JPEG 练习
* RGB->YCbCr
* 降采样
* DCT，人眼对低频更敏感
* 量化
* Zig-Zag
* AC游程编码
* DC差分编码，空间相关性强
* 哈夫曼编码
----
视频压缩原理  
时域冗余，像素差分
* 运动估计
* 运动补偿
* GOP，group of picture
  * I帧，降低错误
  * P帧，参考前面的P，I
  * B帧，参考前后中最接近的
  * 由I帧开始
  * 编码顺序与播放顺序不同

视频压缩标准
* H.264
  * 可变大小分块，找出编码最短的方式
  * 1/4像素精度运动补偿
  * 多个参考帧运动补偿
  * 帧内预测，9种4\*4，4种16*16
  * 帧间预测

可变规模编码

----
## 第3章：信息隐藏
概述
* 隐蔽通信模型
* 信息隐藏的攻防目标
  * 攻：发现和破坏隐秘消息
  * 守：尽可能多地隐藏信息，且不让对手发现破绽
* 可行性
  * 人类感知冗余
  * 计算机系统处理的冗余
  * 潜信道
* 密码学的弊端
  * 明确地提示攻击者哪些是重要信息
  * 一旦被破译就全完了
  * 攻击者可以破坏信息，两败俱伤
* 信息隐藏+密码学
  * 加密：保护秘密信息
  * 掩盖秘密信息存在的实时
* 分类
  * 隐蔽信道
  * 隐写术
    * 语言上
    * 技术上
  * 匿名
  * 版权标识
    * 鲁棒的
      * 数字水印（可见、不可见）
      * 数字指纹
    * 脆弱的
  

隐写术
* 隐写系统评价标准
  * 不可感知性：嵌入前后载体差别
  * 隐藏容量：嵌入率相同的情况下，越难被分析出越好
  * 安全性：确保嵌入信息的保密性
* 隐写分析：攻击，达到检测、破坏甚至提取
  * 主动攻击：在不影响媒体使用价值的前提下，破坏秘密信息
  * 被动：检测是否有秘密信息并提取

版权标识
* 数字水印
  * 包含所有者信息和数字时间戳
  * 生成
    * 无意义的随机数：鲁棒性差，易被攻击
    * 有意义的水印：即使水印质量下降仍可以观察出含义
  * 嵌入
    * 公钥嵌入
  * 提取
    * 私钥提取
    * 返回水印（有意义）或可信度测量（无意义）
    * 盲，非盲，半盲（不需要原始载体数据，但是需要原始水印）
  * 评价标准
    * 不可感知性
    * 嵌入容量
    * 安全性
    * 鲁棒性
  * 攻击
    * 去除攻击
      * 有损压缩
      * 信号处理：滤波、锐化
    * 表达攻击：使水印无法被检测
      * 同步攻击
      * 几何变换
    * 解释攻击：伪造水印
      * 混淆攻击：嵌入其它数字水印，使得检测出的水印存在多个解释
    * 法律攻击
* 数字指纹
  * 作用：标识用户，使得所有者可以跟踪到用户
  * 合谋攻击：攻击者获得一定量的拷贝后，通过比较这些拷贝找到、生成或删除拷贝中的指纹
  * 要求
    * 抵抗合谋攻击
    * 不可察觉性
    * 鲁棒性
  * 主要应用
    * 版权保护

比较隐写术、数字水印和数字指纹

----
图像信息隐藏  
空域

* 非自适应：LSB替换
  * 嵌入
    * 对秘密信息加密
    * 选取嵌入信息的像素：顺序或随机
    * 替换LSB
    * 值对现象
      * 原理：原本2i+1和2i相差较大，而秘密信息0和1的概率相近
    * $X^2$ 隐写分析
      * 构造变量$X^2_{k-1}=\sum_{i=1}^k{\frac{(N_{2i}-N_{2i}^{'})^2}{N_{2i}^{'}}}$符合X2分布
      * 适用条件
        * 密文0和1概率接近
        * 特定的LSB替换（2i<->2i+1）
        * 特定的载体图像（2i和2i+1相差较大）
        * 高容量嵌入
      * 抵抗方法
        * 降低嵌入容量（无法抵抗RS）
        * 直方图补偿
    * RS隐写分析
      * 原理：利用翻转不对称性，考察空间相关性的偏离程度，估计信息嵌入率
      * $F_1$非负翻转，$F_{-1}$非正翻转
      * 低容量、加密可以分析
      * 抵抗方法
        * 特定载体
        * 特定嵌入规则
* 非自适应：LSB匹配
  * 对于非0或255的像素值，随机+1或者-1，杜绝值对现象
* 自适应：根据图像的局部特性调节嵌入数据的多少
  * BPCS
    * 嵌入
      * 将多个位平面分成固定大小的小块，选择其中复杂度大于$aC_{max}$的块
      * 将秘密信息也分为小块并计算其复杂度，若大于a则直接替换，否则异或棋盘块再替换
      * 记录哪些块异或处理过
      * a必须小于0.5：如果大于0.5，即使异或棋盘块也无法使复杂度大于a
      * 复杂度计算：对8*8的块，$C_{max}$=112
    * 提取
      * 选择复杂度大于$aC_{max}$的块
      * 对异或处理过的块再异或处理恢复信息

变换域
* JSTEG
  * 嵌入：跳过0、-1和1，使用huffman编码进行LSB替换，即负偶数为1
  * 提取：绝对值大于1的LSB
  * 值对现象
* F4
  * 嵌入：非0的所有像素，若LSB和秘密信息不匹配，绝对值-1  
  如果嵌入后为0视为嵌入失败
  * 提取：非0的所有像素LSB
* F5
  * 随即嵌入&矩阵编码
  * 嵌入：k个密文为一组，$2^k$-1个像素值为一组，k比特密文只修改1个像素值，绝对值-1  
  如果嵌入后为0视为嵌入失败
  * 提取：$2^k$-1个像素值的异或
  * 载体利用率低
* 可逆信息隐藏
  * 嵌入（绝对值）  
  =N，嵌入1则绝对值+1  
  <N，不变  
  \>N，绝对值+1
  * 提取（绝对值）  
  =N+1，提取1  
  <N，不变  
  \>N，绝对值-1

----
视频信息隐藏  
* 要求
  * 不可感知
  * 鲁棒性
  * 复杂度（提取和检测实时）
  * 考虑压缩编码
  * 不应增加视频码率
* 分类
  * 是否参照原视频：盲或非盲
  * 提取结果：检测或提取
  * 嵌入时机：前、中、后
* 前置：嵌入原始视频流
  * 算法成熟，水印嵌入方法多
  * 压缩导致部分秘密信息丢失
  * 对于已压缩的视频需要先解码再编码，算法效率低
* 内置：嵌入DCT系数
  * 视频质量好，抗攻击，不会增加太多比特率
  * 如果量化前嵌入，部分秘密信息丢失
  * 对于已压缩的视频需要解压后重新压缩，很慢
  * 修改编码器
* 后置：嵌入压缩码流
  * 无需解码再编码，效率高
  * 压缩比特率限制了嵌入容量，嵌入后可能有可察觉的变化
  * 失真漂移：影响视觉效果，限制嵌入容量
* 解决帧内预测失真漂移
  * 例如在残差R嵌入信息，根据帧内预测方式选择耦合系数对

----
## 第4章：加密
概述  
* 使多媒体数据内容在视觉上无法辨认或降质到不可接受
* 需求
  * 复杂度低
  * 内容安全
  * 压缩效率
  * 鲁棒性
  * 自适应和可扩展
* 安全攻击
  * 完全破解：通过寻找到密钥完全恢复明文比特流
  * 视觉破解：没有密钥，但是通过变换得到视觉质量可接受的数据
  * 局部破解：局部明文比特流或内容信息
  * 信息揣测：获得关于密钥和明文比特流的某些信息
* 特有安全攻击
  * 统计攻击：利用多媒体数据不同部分之间的关系推测明文
  * 基于错误隐藏的攻击：将加密部分当作错误，用周围帧推测错误帧
* 加密方法
  * 传统方法
  * 选择加密
    * 前置
      * 兼容性好
      * 有损
      * 带宽变大
    * 内置
      * 结合压缩和加密
      * 修改编码器和解码器
      * 不利于兼容和压缩
    * 后置
      * 利于压缩
      * 无需修改解码器
  * 特殊加密
    * 压缩与加密联合
    * 可扩展加密


实例：在隐私保护的同时实现运动检测
* 评价
  * 易懂性
  * 安全
  * 压缩效率
  * 计算复杂度
  * 兼容
  * 完全可逆
* 时机
  * 空域，前置
  * 变换域，内置
  * 压缩域，后置
* 问题：帧内和帧间预测导致失真漂移
  * 采用之前的解法，则隐私区域保密性变差
  * 扰乱后进行补偿
  * 加密方拥有加密前的像素值和加密后的像素值，计算像素域之差经过DCT和量化后加到熵编码
  * 解密方解密，得到加密前的像素值，计算像素域之差经量化和DCT得到补偿信号，熵编码减去补偿信号即可得到正确的预测值
  * 逐块处理，补偿并重建后再处理下一块

实例：监控密文运动检测
* 混合高斯分布：符合高斯分布的独立随机变量的和仍然属于高斯分布
* 原理：假设每个像素的值符合混合高斯分布，每当有新的像素值，将其与已有高斯分布匹配，若不匹配，则将其作为新的高斯分布模型。最终前B个高斯模型作为背景。
* 逐帧加密
  * 随机颜色反转，得到平滑的噪声图片
  * 位置扰乱
  * 乘加密矩阵（每个值都在1~2，避免权重过大，行列式绝对值大于1，可逆）
  * 逆扰乱
  * 量化
  * 压缩（可选）
  * 最终得到每个加密像素都是N个明文像素的线性组合，若明文为前景，则密文仍为前景的可能性很大

实例：JPEG图像同态密文解压缩
* 解决问题：服务器不知道图像内容的情况下解压缩，客户端不需要进行密文膨胀的同态加密
* 流程
  * 客户端同态加密对称密钥，对称加密密文，生成同态加密公钥
  * 服务器同态加密密文，对称解密密文，同态域解压缩
  * 
* 解压缩流程
  * 计算[b]，表示是否匹配
  * 计算C，表示DCT系数
  * 计算newbits，表示下一轮的密文

